---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog', ({ data }) => import.meta.env.PROD ? data.draft !== true : true))
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<Layout>
  <header class="mb-6">
    <h1 class="text-3xl font-semibold">Blog</h1>
    <p class="text-sm text-slate-600">Latest posts</p>
  </header>

  <ul class="grid gap-4">
    {posts.map((post) => (
      <li class="bg-white rounded-lg p-4 border border-gray-100 shadow-sm">
        <a class="block" href={`/blog/${post.id}/`}>
          <h2 class="text-xl font-medium">{post.data.title}</h2>
          <p class="mt-2 text-sm text-slate-600">{post.data.description}</p>
          <div class="mt-3 text-xs text-slate-500">{post.data.pubDate.toDateString()}</div>
        </a>
      </li>
    ))}
  </ul>
</Layout>
